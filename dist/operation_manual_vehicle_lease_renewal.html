<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
      :root { color-scheme: light; }
      body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans JP", sans-serif; line-height: 1.6; padding: 16px; }
      h1 { font-size: 20px; margin: 0 0 12px; }
      h2 { font-size: 16px; margin: 18px 0 8px; border-top: 1px solid #eee; padding-top: 12px; }
      h3 { font-size: 14px; margin: 14px 0 6px; }
      p { margin: 8px 0; }
      ul, ol { margin: 8px 0 8px 20px; padding: 0; }
      li { margin: 4px 0; }
      code { background: #f6f8fa; padding: 1px 4px; border-radius: 4px; }
      pre { background: #f6f8fa; padding: 10px; border-radius: 8px; overflow: auto; }
      pre code { background: none; padding: 0; }
      .footer { margin-top: 18px; font-size: 12px; color: #666; }
    </style>
  </head>
  <body>
<h1>運用マニュアル（クライアント向け）: 車両リース契約 更新通知ツール（半期一括）</h1>
<p>このドキュメントは、半期ごとに「契約満了が近い車両」を一括で通知し、確認用シートで回答・承認・反映まで進める<strong>日常運用手順</strong>をまとめたものです。</p>
<p>（作成日: 2026-02-06）</p>
<hr>
<h2>1. このツールでできること（ざっくり）</h2>
<ol>
<li>半期レンジ（3月/9月）+ 過去未反映分をまとめて抽出する</li>
<li>本部長/副本部長へ確認用シートの通知を送る</li>
<li>回答確認済みで専務に承認依頼を送る</li>
<li>村田主任の入力（更新日付 or 解約完了）を受けて台帳へ反映する</li>
<li>送信・反映の履歴を <code>通知ログ</code> に記録する</li>
</ol>
<hr>
<h2>2. 触る場所（タブ）</h2>
<p>普段よく見るのは次のタブです。</p>
<ul>
<li><code>車両一覧</code>（元台帳）</li>
<li>ここにある「契約満了日」「管理部門」などを元に抽出します</li>
<li>反映時に <code>契約開始日</code> / <code>契約満了日</code> を更新、解約は行全体をグレーアウトします</li>
<li><code>通知バッチ</code></li>
<li>半期ごとの送付単位を管理します（送付日/期限/ステータス）</li>
<li><code>本部長副本部長確認_YYYYMMDD</code></li>
<li>本部長/副本部長の回答、専務判断、反映情報を入力する確認用シートです</li>
<li><code>要入力</code></li>
<li>「契約満了日が無い」など、抽出できない原因が一覧で出ます</li>
<li><code>通知ログ</code></li>
<li>メール送信/反映の成功・失敗が記録されます</li>
<li><code>設定</code></li>
<li>通知先や半期日付、期限、リマインド日数などの設定を管理します</li>
</ul>
<hr>
<h2>3. 本部長/副本部長の手順（確認用シート）</h2>
<p>通知メールが届いたら、次を行います。</p>
<ol>
<li>メール内の「確認シート」を開く</li>
<li>各車両の <code>本部回答</code> を入力する（更新 / 解約（入替） / 解約（満了））</li>
<li>入力が終わったら <code>回答確認済み</code> にチェックを付ける</li>
</ol>
<hr>
<h2>4. 専務の手順（承認）</h2>
<ol>
<li>専務宛の通知メールから確認用シートを開く</li>
<li>各車両の <code>専務判断</code> を入力する（承認 / 差戻し）</li>
<li>必要に応じて <code>専務コメント</code> を入力する</li>
</ol>
<p>※ <code>専務判断</code> / <code>専務コメント</code> は専務のみ編集可能です（列保護あり）。</p>
<hr>
<h2>5. 運用担当（村田主任）の手順（反映）</h2>
<ol>
<li>承認済み行に対して、次を入力します</li>
</ol>
<ul>
<li>更新: <code>新契約開始日</code> / <code>新契約満了日</code></li>
<li>解約: <code>解約完了</code> チェック</li>
</ul>
<ol>
<li>メニュー <code>車両更新通知</code> → <code>専務判断反映・マスター更新</code> を実行します</li>
<li>台帳（<code>車両一覧</code>）に反映されたことを確認します</li>
</ol>
<hr>
<h2>6. 定期運用（半期）</h2>
<h3>6.1 半期バッチ作成</h3>
<ul>
<li>3月1日 / 9月1日にメニュー <code>車両更新通知</code> → <code>半期バッチ作成</code> を実行します</li>
<li>実行後、<code>通知バッチ</code> と <code>本部長副本部長確認_YYYYMMDD</code> が生成されます</li>
</ul>
<h3>6.2 通知の流れ</h3>
<ul>
<li><code>本部長/副本部長 初回通知送信</code></li>
<li>期限10日前に未確認が残っていれば <code>本部長/副本部長 リマインド送信</code></li>
<li>全件 <code>回答確認済み</code> で <code>専務 承認依頼送信</code></li>
</ul>
<hr>
<h2>7. 初期設定（最初に1回だけ）</h2>
<p>※ここは「スプレッドシートの管理者」向けです。設定済みなら飛ばしてください。</p>
<h3>7.1 メニューが出ることを確認</h3>
<p>スプレッドシートを開くと、上部メニューに <code>車両更新通知</code> が出ます。</p>
<p>初回は権限確認が出ることがあります。案内に従って許可してください。</p>
<h3>7.2 必要タブを作る（スキーマ同期）</h3>
<p>メニュー <code>車両更新通知</code> → <code>スキーマ同期</code></p>
<h3>7.3 設定を入れる</h3>
<p>タブ <code>設定</code> で、最低限次を確認します。</p>
<ul>
<li><code>本部長副本部長_通知先To</code></li>
<li><code>専務_通知先To</code> / <code>専務_通知先Cc</code></li>
<li><code>半期送付日_3月</code> / <code>半期送付日_9月</code></li>
<li><code>回答期限_3月</code> / <code>回答期限_9月</code></li>
<li><code>リマインド_期限前日数</code></li>
<li><code>通知_メール送信</code>（TRUEで送信、FALSEで送らない）</li>
</ul>
<h3>7.4 自動実行（平日朝）を設定する</h3>
<p>自動実行が必要な場合は、メニュー <code>車両更新通知</code> → <code>日次トリガー再作成</code> を実行します。</p>
<hr>
<h2>8. 困ったとき（よくある原因と対処）</h2>
<h3>8.1 メールが送られていない/失敗している</h3>
<ol>
<li><code>通知ログ</code> を開いて、失敗理由を確認します</li>
<li>多い原因:</li>
</ol>
<ul>
<li><code>本部長副本部長_通知先To</code> が空</li>
<li><code>専務_通知先To</code> が空</li>
<li><code>通知_メール送信</code> が FALSE</li>
</ul>
<p>原因を直したら、メニュー <code>車両更新通知</code> → 該当の送信メニューを実行します。</p>
<h3>8.2 <code>要入力</code> に出ている（抽出できない車両がある）</h3>
<p><code>要入力</code> に出た行の「不備内容」を見て、元台帳で直します。</p>
<ul>
<li><code>契約満了日が未設定</code> → 元台帳に満了日を入力</li>
</ul>
<p>修正後、次回の <code>半期バッチ作成</code> で対象化されます。</p>
<h3>8.3 反映されない</h3>
<ul>
<li><code>専務判断</code> が「承認」になっているか</li>
<li><code>新契約開始日</code> / <code>新契約満了日</code> または <code>解約完了</code> が入力されているか</li>
<li>メニュー <code>専務判断反映・マスター更新</code> を実行したか</li>
</ul>
<hr>
<h2>9. 台帳に追加される列（自動で増えます）</h2>
<p>元台帳（<code>車両一覧</code>）の右端に、次の列が追加されます。</p>
<ul>
<li><code>マスター反映済み</code></li>
<li><code>反映日時</code></li>
</ul>
<hr>
<h2>10. やってはいけないこと</h2>
<ul>
<li>タブ名を変更/削除しない（特に <code>設定</code> / <code>通知バッチ</code> / <code>通知ログ</code> / <code>要入力</code>）</li>
<li>1行目（見出し行）の文字を勝手に変えない</li>
</ul>

    <div class="footer">このページはMarkdownから自動生成されています。</div>
  </body>
</html>
